
---

### **Feature Cluster 1 — Agent Runtime Core (AutoGen 0.6 / `autogen-core`)**

| #     | Feature                         | What it delivers                                                                                                                                                                                        | AutoGen-core touch-points                                                                       |
| ----- | ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------- |
| **A** | **Bootstrap & Container**       | OCI image (≤ 250 MB) bundling `autogen-core`, `uvicorn`, `fastapi`, `opentelemetry-sdk`, plus Quillux code. ENTRYPOINT parses `config.yaml` / env-vars, registers agents, and starts `runtime.start()`. | Install via `pip`, standard single-entrypoint pattern in AutoGen-core quickstart.               |
| **B** | **Runtime Instantiation**       | Factory pattern for `SingleThreadedAgentRuntime` (dev) vs `DistributedAgentRuntime` (prod). Both injected with tracing and structured logger.                                                           | Matches quickstart examples for single/distributed runtimes.                                    |
| **C** | **Agent Registration Layer**    | `register_agents(runtime, cfg)` mounts internal agents (`SchemaCrawler`, `DocIngestor`, `Enricher`, etc.) as `RoutedAgent` instances with `@default_subscription`.                                      | AutoGen-core agent definition + registration patterns.                                          |
| **D** | **Typed Message Contracts**     | Dataclass messages in `quillux.messages.*` (e.g., `IntrospectJob`, `SchemaSnapshot`, `EnrichmentProposal`). Versioned with `schema_version` attr.                                                       | Follows AutoGen-core message typing with handlers.                                              |
| **E** | **Event-Driven Scheduler**      | Async cron-like task that posts `CronTick` messages every *N* minutes. Agents subscribe to trigger crawling, profiling, drift-check. Manual HTTP triggers → message bus.                                | Uses async `publish_message` in AutoGen-core.                                                   |
| **F** | **FastAPI Bridge**              | REST façade converting HTTP calls into runtime messages, awaiting replies. Endpoints: `/health`, `/ready`, `/mcp/schema`, `/a2a/card`, `/metrics`, `/introspect`. SSE for streaming responses.          | AutoGen-core request/response pattern.                                                          |
| **G** | **Config & Secrets Management** | `AgentSettings(ComponentConfig)` auto-loads YAML/env-vars. Secrets pulled from Azure Key Vault or K8s secrets. Hot-reload support via `SIGHUP`.                                                         | Uses standard ComponentConfig loader pattern.                                                   |
| **H** | **Lifecycle & Hot-Reload**      | Signal handling for `SIGINT`, `SIGTERM` (clean shutdown with `stop_when_idle`); `SIGHUP` triggers config reload and agent re-instantiation without downtime.                                            | Compatible with AutoGen-core lifecycle APIs.                                                    |
| **I** | **Observability Hooks**         | OpenTelemetry spans around message routing and long tasks. Structured LLM-usage events. `/metrics` endpoint exposes Prometheus metrics.                                                                 | AutoGen-core instrumentation and tracing integration.                                           |
| **J** | **CLI & Dev UX**                | `quillux-agent init <source>` scaffolds config. `quillux-agent run --reload` boots uvicorn with hot-reload. `test-connection` sends a `Probe` message and prints result.                                | CLI interacts with AutoGen-core runtime.                                                        |
| **K** | **Security Baseline**           | Non-root container user, read-only filesystem, SBOM. Bearer-token propagation for downstream RLS. Secrets never logged. Actor isolation—messages are pure data.                                         | Token included in message context; agents enforce row-level filtering.                          |
| **L** | **IAM Policy Stub Interface**   | Optional middleware hook to evaluate caller’s bearer-token against org IAM (e.g., Azure Entra) for ACL decisions. Initially logs-only or no-op, but pluggable for future enterprise integration.        | `@message_handler` can call policy engine before executing. Token is carried in message schema. |

---


